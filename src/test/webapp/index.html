<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
    "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <title>CORS Test</title>
    <script type="text/javascript" src="json2.js"></script>
    <script type="text/javascript" src="jquery-1.7.2.js"></script>
    <script type="text/javascript" src="jquery.json-2.2.js"></script>
    <script type="text/javascript">

        document.domain = '@{System.getProperty("domain", "mycila.intra")}';

        XDR_SESSION_COOKIE_NAME = 'id';
        XDR_COOKIE_HEADERS = ['rmb', 'locale'];
        XDR_HEADERS = ['Content-Type'];
        XDR_DEBUG = true;

        jQuery.ajaxSetup({
            cache:false,
            xhrFields:{
                withCredentials:true
            }
        });

        jQuery(function ($) {
            $('button').click(function () {
                if ('GET' == $(this).attr('method')) {
                    $.ajax({
                        type:'GET',
                        url:'http://service.mycila.intra/echo',
                        data:{
                            msg:$('#msg').val()
                        },
                        dataType:'json',
                        success:function (d) {
                            console.log(d);
                            $('#response').append('<pre>' + d['val'] + '</pre>');
                        }
                    });
                } else {
                    var ct = $(this).attr('ct');
                    $.ajax({
                        type:'POST',
                        url:'http://service.mycila.intra/echo',
                        data:ct.indexOf('json') == -1 ? {msg:$('#msg').val()} : $.toJSON({msg:$('#msg').val()}),
                        dataType:'json',
                        contentType:ct,
                        success:function (d) {
                            console.log(d);
                            $('#response').append('<pre>' + d['val'] + '</pre>');
                        }
                    });

                }
            });
        });
    </script>
    <script type="text/javascript" src="file/src/main/resources/com/ovea/cors/jquery.ie.cors.js"></script>
    <!--<script type="text/javascript" src="file/target/classes/com/ovea/cors/jquery.ie.cors-min.js"></script>-->
</head>
<body>
<label for="msg">Message: </label><input id="msg" type="text" value="some text">
<button method="GET">GET</button>
<button method="POST" ct="application/x-www-form-urlencoded; charset=UTF-8">POST (form)</button>
<button method="POST" ct="application/json; charset=UTF-8">POST (json)</button>
<div id="response"></div>
</body>
</html>
